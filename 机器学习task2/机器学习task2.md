# 机器学习task2
[github链接](git@github.com:cailibin00/machinelearning.git)
## 1.简单记录我的思考
* **问题1.计算机采用什么数据结构存储，处理图像？**
* **回答1**：图像在计算机中最基本的表示是一个二维或三维的**像素阵列**
对于**灰度**图像，每个像素通常用一个字节表示，范围从0（黑色）到255（白色）。
对于彩色图像，每个像素可能由三个字节表示，分别对应红色、绿色和蓝色三个channel

* **问题2.如何设计一个神经网络？一个神经网络通常包括哪些部分？**
* **回答2**：我们用本题做例子：
**第一个问号**:1.首先，确定神经网络用于分类，回归还是其他任务，然后选择模型，本题用于分类，据此选择CNN模型
2.其次，根据数据或者图像的复杂程度，确定网络中的层数和每层的类型（如全连接层、卷积层、池化层）以及每层的参数（如神经元数量、卷积核大小等），还有选择合适的激活函数（ReLU,Sigmoid等）
3.设计损失函数：根据问题类型选择合适的损失函数，交叉熵损失用于分类问题，均方误差损失用于回归问题。本题目属于分类问题，使用交叉熵损失
4.选择优化器：选择用于训练网络的优化算法，如梯度下降（SGD）、Adam等，本题使用SGD
5.设置训练参数：定义训练过程中的参数，如learning_rate，epoch，batch_size等,本题目使用合适的参数来得到较好的效果
**第二个问号**:神经网络包括：输入层，隐藏层，输出层，激活函数，损失函数，优化器

* **问题3.欠拟合和过拟合是什么？**
* **回答3**：欠拟合就是模型过简单，无法学习、捕捉到复杂信息，导致误差过大，可能是学习率过小，训练次数太少等原因导致；过拟合：模型过于复杂或者训练时间过长，捕捉到过多噪点和细节，在训练集表现良好，但是在未见过的数据表现不佳


## 2.代码实现思路
大体上，按照框架的结构，细节上做了一些小改动
* **框架结构**：首先获得图像，载入数据库的时候通过transform进行处理，接着便是创建数据加载器，使得样本分割成多个batch_size大小，如何就是神经网络的构建（包括CNN和resnet）,定义交叉熵函数和SGD优化器，把数据通过测试集和验证集，训练和评估训练结果，最后得到满意的模型，再进行测试集的测试

* **改动1**.在数据处理方面：在transforms之中添加了归一化,水平翻转,随机裁剪，利用这些数据增强技术，用于提高模型的泛化能力
* **改动2**.在填写参数大小的时候，选择了128的batch_size和0.01的学习率，都是比较正常，保守的值
* **改动3**.在构建CNN的时候，我认为该模型需要提取的特征比较多，在使用三个卷积层训练过MNIST数据集之后，我打算使用更加复杂的三层卷积层在SIFAR10数据集中并且，使用边长为3的卷积核，选择padding=1，stride=1的参数，一方面，是为了方便自己计算，一方面，我认为边长为5对于这个模型来说过大，导致图像的长款缩小太快，不利于多层卷积层的使用；在MaxPool时，选择了kernel_size=2，搭配卷积核为3的大小。接下来到达了全连接层，现在view展平之后得到了64 * 8 * 8的特征值，我觉得->512->10可能导致欠拟合，因此，64*8*8->1024->512->10
* **改动4**.填写交叉熵损失函数，SGD优化器，并让momentum=0.9，加速收敛速度

### 遇到的困难
* **困难0.5**：在尝试归一化数据的时候，我不明白mean()和std()如何计算，想了半天最后还是上网查找资料，得到了SIFAR10的两组参数
* **困难0.9**：在下载SIFAR10的时候太慢了，我把dowmload改成false，然后从晚上下载了数据包
* **困难1**：在写完自认为满意的参数之后，我开始运行程序，然后算出来10%的准确率，，自认为CNN之中的参数出大问题，修改又修改，硬是从下午该到了晚上，然后还是10%。休息一会之后，我想到train函数中设计了一个使用plt画图的程序，但是始终没有图像冒出来，就在train函数中设置了断点，然后再开始调试，但是代码还是能跑出来，而且准确率还是10%，然而图像还是没有出现。
我明白了，10分类问题，我随便猜都能10%，相当于根本没进行训练（笑了），然后我就看到if \_\_name\_\_="\_\_main\_\_":之后是train函数的调用，我便把if语句删除了，程序便跑出来68%的准确率。激动万分
![pic](/68.png)
好吧还是看不懂

* **困难2**：准确率太低，68%的准确率实在不高，我便继续学习，认识到dropout和残差块能提高准确率，我便学习完原理之后他们加进去了，得到更好的CNN模型；并且，我把num_epoch增加到25，防止欠拟合的问题，这次便得到了76%的准确率之后，我还添加了正则化参数，把卷积层减少为2个，在这时候，也只能得到80%的准确率，已经是我的极限
![pic](/80.png)